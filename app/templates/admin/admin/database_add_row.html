{% extends "admin/admin/base.html" %}

{% block header %}
âž• Add Row to: {{ table_name }}
{% endblock %}

{% block content %}
<div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
    <div class="mb-4">
        <a href="{{ url_for('admin_database_table_view', table_name=table_name) }}" class="text-blue-600 hover:text-blue-800 dark:text-blue-400">
            <i class="fas fa-arrow-left mr-2"></i> Back to Table
        </a>
    </div>

    <form method="POST" action="{{ url_for('admin_database_add_row', table_name=table_name) }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="space-y-4">
            {% for col in columns %}
                {% if not col.get('autoincrement', False) %}
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        {{ col.name }}
                        {% if not col.get('nullable', True) and not col.get('default') %}
                            <span class="text-red-500">*</span>
                        {% endif %}
                        <span class="text-xs text-gray-500 dark:text-gray-400">({{ col.type }})</span>
                    </label>
                    {% set col_type = col.type|string|upper %}
                    {% if 'TEXT' in col_type or 'VARCHAR' in col_type or 'CHAR' in col_type %}
                        {% if col_type|length > 100 %}
                            <textarea name="{{ col.name }}" rows="4" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}></textarea>
                        {% else %}
                            <input type="text" name="{{ col.name }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                        {% endif %}
                    {% elif 'INTEGER' in col_type or 'INT' in col_type %}
                        <input type="number" name="{{ col.name }}" step="1" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                    {% elif 'REAL' in col_type or 'FLOAT' in col_type or 'DOUBLE' in col_type %}
                        <input type="number" name="{{ col.name }}" step="0.01" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                    {% elif 'BOOLEAN' in col_type or 'BOOL' in col_type %}
                        <select name="{{ col.name }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                            <option value="">-- Select --</option>
                            <option value="1">True</option>
                            <option value="0">False</option>
                        </select>
                    {% elif 'DATE' in col_type or 'TIME' in col_type or 'DATETIME' in col_type %}
                        {% if 'DATETIME' in col_type %}
                            <input type="datetime-local" name="{{ col.name }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                        {% elif 'DATE' in col_type %}
                            <input type="date" name="{{ col.name }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                        {% else %}
                            <input type="time" name="{{ col.name }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                        {% endif %}
                    {% else %}
                        <input type="text" name="{{ col.name }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white" {% if not col.get('nullable', True) and not col.get('default') %}required{% endif %}>
                    {% endif %}
                    {% if col.get('default') %}
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Default: {{ col.default }}</p>
                    {% endif %}
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <div class="mt-6 flex gap-4">
            <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                <i class="fas fa-save mr-2"></i> Save Row
            </button>
            <a href="{{ url_for('admin_database_table_view', table_name=table_name) }}" class="px-6 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">
                Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}

